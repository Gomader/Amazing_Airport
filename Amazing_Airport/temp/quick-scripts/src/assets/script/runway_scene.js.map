{"version":3,"sources":["assets/script/runway_scene.js"],"names":["cc","Class","Component","properties","userid","Integer","runway","type","Node","road","stand","username","Label","stars","fuel","ProgressBar","fuelnum","fuelclock","passenger","passengernum","passengerclock","coins","allfile","Object","maxfuel","leftfuel","maxpassenger","leftpassenger","allclock","onLoad","node","opacity","sys","localStorage","getItem","runstate","Boolean","timenumber","newuser","start","runAction","fadeIn","update","dt","JSON","parse","showmap","director","loadScene","downloadUserData","xhr","XMLHttpRequest","open","setRequestHeader","send","onreadystatechange","readyState","status","responseText","setItem","uploadUserData","stringify","console","log","getChildByName","buildings","uprunway","toString","active","downrunway","string","name","money","progress","startfuelclock"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n        userid:cc.Integer,\n        runway:{\n            type:cc.Node,\n            default:null\n        },\n        road:{\n            type:cc.Node,\n            default:null\n        },\n        stand:{\n            type:cc.Node,\n            default:null\n        },\n        username:{\n            type:cc.Label,\n            default:null\n        },\n        stars:{\n            type:cc.Label,\n            default:null\n        },\n        fuel:{\n            type:cc.ProgressBar,\n            default:null\n        },\n        fuelnum:{\n            type:cc.Label,\n            default:null\n        },\n        fuelclock:{\n            type:cc.Node,\n            default:null\n        },\n        passenger:{\n            type:cc.ProgressBar,\n            default:null\n        },\n        passengernum:{\n            type:cc.Label,\n            default:null\n        },\n        passengerclock:{\n            type:cc.Node,\n            default:null\n        },\n        coins:{\n            type:cc.Label,\n            default:null\n        },\n        allfile:Object,\n        maxfuel:cc.Integer,\n        leftfuel:cc.Integer,\n        maxpassenger:cc.Integer,\n        leftpassenger:cc.Integer,\n        allclock:Object\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.node.opacity = 0;\n        this.userid = cc.sys.localStorage.getItem(\"id\");\n        this.allclock = {\n            fuelclock : {\n                runstate:Boolean,\n                timenumber:0\n            },\n            passengerclock : {\n                runstate:Boolean,\n                timenumber:0\n            }\n        },\n        this.newuser();\n    },\n\n    start () {\n        this.node.runAction(cc.fadeIn(1.0));\n    },\n\n    update (dt) {\n        this.allfile = JSON.parse(cc.sys.localStorage.getItem('userData'));\n        this.showmap();\n    },\n\n    newuser:function(){\n        if(this.userid==null){\n            cc.director.loadScene(\"homepage_scene\");\n        }else{\n            this.downloadUserData();\n        }\n    },\n\n    downloadUserData:function(){\n        var xhr = new XMLHttpRequest();\n        xhr.open(\"POST\", \"https://140.143.126.73/amazing_airport/amazing_airport.php?module=1\", true);\n        xhr.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\");\n        xhr.send(\"id=\" + this.userid);\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 400)) {\n                if (xhr.responseText != 0){\n                    cc.sys.localStorage.setItem('userData',this.responseText);\n                }\n            }\n        };\n    },\n\n    uploadUserData:function(){\n        var xhr = new XMLHttpRequest();\n        xhr.open(\"POST\", \"https://140.143.126.73/amazing_airport/amazing_airport.php?module=2\", true);\n        xhr.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\");\n        xhr.send(\"id=\" + this.userid + \"&userData=\" + JSON.stringify(this.allfile));\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 400)) {\n                if(xhr.responseText == 1){\n                    console.log(1);\n                }\n            }\n        };\n    },\n\n    showmap:function(){\n        this.runway.getChildByName(\"up\").getChildByName(this.allfile.buildings.uprunway.toString()).active = true;\n        this.runway.getChildByName(\"down\").getChildByName(this.allfile.buildings.downrunway.toString()).active = true;\n        if(this.allfile.buildings.uprunway>=9&&this.allfile.buildings.downrunway>=9){\n            this.road.getChildByName(\"9-9\").active = true;\n        }else if(this.allfile.buildings.uprunway>=6&&this.allfile.buildings.downrunway>=6){\n            this.road.getChildByName(\"6-6\").active = true;\n        }else if(this.allfile.buildings.uprunway>=3&&this.allfile.buildings.downrunway>=3){\n            this.road.getChildByName(\"3-3\").active = true;\n        }else{\n            this.road.getChildByName(\"1-1\").active = true;\n        }\n        this.stand.getChildByName(this.allfile.buildings.stand.toString()).active = true;\n        this.username.string = this.allfile.name;\n        this.stars.string = this.allfile.stars;\n        this.coins.string = this.allfile.money;\n        this.maxfuel = this.allfile.stars + 10;\n        this.maxpassenger = this.allfile.stars * 2 + 20;\n        this.fuel.progress = this.leftfuel / this.maxfuel;\n        this.fuelnum.string = this.leftfuel.toString() + \"/\" + this.maxfuel.toString();\n        this.passenger.progress = this.leftpassenger / this.maxpassenger;\n        this.passengernum.string = this.leftpassenger.toString() + \"/\" + this.maxpassenger.toString();\n        if (this.leftfuel < this.maxfuel && this.allclock.fuelclock.runstate == false){\n            this.fuelclock.active = true;\n\n        }\n    },\n    startfuelclock:function(){\n        \n    }\n});\n"]}