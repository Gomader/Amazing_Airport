
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/script/button_events.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'd4201dx8t5KJ4AqSM5Q3YV2', 'button_events');
// script/button_events.js

"use strict";

// Learn cc.Class:
//  - https://docs.cocos.com/creator/manual/en/scripting/class.html
// Learn Attribute:
//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html
// Learn life-cycle callbacks:
//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html
var userdata = require('userdata');

cc.Class({
  "extends": cc.Component,
  properties: {
    my_flights_window: {
      type: cc.Node,
      "default": null
    },
    warehouse_window: {
      type: cc.Node,
      "default": null
    },
    activeflights: {
      type: cc.Node,
      "default": null
    },
    flights: {
      type: cc.Node,
      "default": null
    },
    shop_window: {
      type: cc.Node,
      "default": null
    },
    buildings_window: {
      type: cc.Node,
      "default": null
    },
    business_flights_window: {
      type: cc.Node,
      "default": null
    },
    setting_windows: {
      type: cc.Node,
      "default": null
    },
    warning_window: {
      type: cc.Node,
      "default": null
    },
    window: {
      type: cc.Node,
      "default": null
    },
    airplanes: {
      type: cc.Node,
      "default": null
    }
  },
  // LIFE-CYCLE CALLBACKS:
  onLoad: function onLoad() {},
  start: function start() {},
  update: function update(dt) {},
  showallflights: function showallflights() {
    this.hide();
    var a = cc.instantiate(this.my_flights_window);
    a.active = true;
    a.getChildByName("active").active = false;
    a.getChildByName("inner").active = true;
    this.window.addChild(a);
  },
  showflying: function showflying() {
    this.hide();
    var a = cc.instantiate(this.my_flights_window);
    a.active = true;
    a.getChildByName("active").active = true;
    a.getChildByName("inner").active = false;
    this.window.addChild(a);
  },
  showwarehouse: function showwarehouse() {
    this.hide();
    var a = cc.instantiate(this.warehouse_window);
    a.active = true;
    this.window.addChild(a);
  },
  fly: function fly(event, customEventData) {
    this.hide();
    var go = 0;

    if (userdata.lefts.leftfuel >= customEventData.fuel && userdata.lefts.leftpassenger >= customEventData.passenger) {
      for (var o in userdata.airplanedata) {
        if (userdata.airplanedata[o].level == customEventData.level && userdata.airplanedata[o].isflying == 'false') {
          userdata.airplanedata[o].isflying = 'true';
          userdata.airplanedata[o].destination = customEventData.name;
          userdata.airplanedata[o].reward = customEventData.reward;
          userdata.airplanedata[o].endtime = Date.parse(new Date()) / 1000 + customEventData.time;
          userdata.lefts.leftfuel -= customEventData.fuel;
          userdata.lefts.leftpassenger -= customEventData.passenger;

          if (userdata.achievement[customEventData.id][1] == 3) {
            console.log("r");
          } else {
            userdata.achievement[customEventData.id][0] += 1;

            if (userdata.achievement[customEventData.id][0] == 10) {
              userdata.achievement[customEventData.id][1] += 1;
              userdata.allfile.stars += 1;
              userdata.achievement[customEventData.id][0] = 0;
            }
          }

          go = 1;
          break;
        }
      }
    }

    if (go == 0) {
      if (userdata.lefts.leftfuel < customEventData.fuel || userdata.lefts.leftpassenger < customEventData.passenger) {
        var inner = 'Do not have enough fuel or passengers';
        this.showwarning(inner);
      } else {
        var _inner = 'Do not have an avilable plane of the required type.\nBuy a new plane or wait for the current flights to return.';
        this.showwarning(_inner);
      }
    }
  },
  toactive: function toactive() {
    this.window.getChildByName("My_flights_window").getChildByName("active").active = true;
    this.window.getChildByName("My_flights_window").getChildByName("inner").active = false;
  },
  toflightlist: function toflightlist() {
    this.window.getChildByName("My_flights_window").getChildByName("active").active = false;
    this.window.getChildByName("My_flights_window").getChildByName("inner").active = true;
  },
  showwarning: function showwarning(inner) {
    this.warning_window.getChildByName("warning_window").getChildByName("inner").getComponent(cc.Label).string = inner;
    var a = cc.instantiate(warning_window);
    a.active = true;
    this.window.addChild(a);
  },
  showsetting: function showsetting() {
    this.hide();
    var a = cc.instantiate(this.setting_windows);
    a.active = true;
    this.window.addChild(a);
  },
  showshop: function showshop() {
    this.hide();
    var a = cc.instantiate(this.shop_window);
    a.active = true;
    this.window.addChild(a);
  },
  showbuildings: function showbuildings() {
    this.hide();
    var a = cc.instantiate(this.buildings_window);
    a.active = true;
    this.window.addChild(a);
  },
  showbusiness: function showbusiness() {
    this.hide();
    var a = cc.instantiate(this.business_flights_window);
    a.active = true;
    this.window.addChild(a);
  },
  hide: function hide() {
    this.window.destroyAllChildren();
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9zY3JpcHQvYnV0dG9uX2V2ZW50cy5qcyJdLCJuYW1lcyI6WyJ1c2VyZGF0YSIsInJlcXVpcmUiLCJjYyIsIkNsYXNzIiwiQ29tcG9uZW50IiwicHJvcGVydGllcyIsIm15X2ZsaWdodHNfd2luZG93IiwidHlwZSIsIk5vZGUiLCJ3YXJlaG91c2Vfd2luZG93IiwiYWN0aXZlZmxpZ2h0cyIsImZsaWdodHMiLCJzaG9wX3dpbmRvdyIsImJ1aWxkaW5nc193aW5kb3ciLCJidXNpbmVzc19mbGlnaHRzX3dpbmRvdyIsInNldHRpbmdfd2luZG93cyIsIndhcm5pbmdfd2luZG93Iiwid2luZG93IiwiYWlycGxhbmVzIiwib25Mb2FkIiwic3RhcnQiLCJ1cGRhdGUiLCJkdCIsInNob3dhbGxmbGlnaHRzIiwiaGlkZSIsImEiLCJpbnN0YW50aWF0ZSIsImFjdGl2ZSIsImdldENoaWxkQnlOYW1lIiwiYWRkQ2hpbGQiLCJzaG93Zmx5aW5nIiwic2hvd3dhcmVob3VzZSIsImZseSIsImV2ZW50IiwiY3VzdG9tRXZlbnREYXRhIiwiZ28iLCJsZWZ0cyIsImxlZnRmdWVsIiwiZnVlbCIsImxlZnRwYXNzZW5nZXIiLCJwYXNzZW5nZXIiLCJvIiwiYWlycGxhbmVkYXRhIiwibGV2ZWwiLCJpc2ZseWluZyIsImRlc3RpbmF0aW9uIiwibmFtZSIsInJld2FyZCIsImVuZHRpbWUiLCJEYXRlIiwicGFyc2UiLCJ0aW1lIiwiYWNoaWV2ZW1lbnQiLCJpZCIsImNvbnNvbGUiLCJsb2ciLCJhbGxmaWxlIiwic3RhcnMiLCJpbm5lciIsInNob3d3YXJuaW5nIiwidG9hY3RpdmUiLCJ0b2ZsaWdodGxpc3QiLCJnZXRDb21wb25lbnQiLCJMYWJlbCIsInN0cmluZyIsInNob3dzZXR0aW5nIiwic2hvd3Nob3AiLCJzaG93YnVpbGRpbmdzIiwic2hvd2J1c2luZXNzIiwiZGVzdHJveUFsbENoaWxkcmVuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7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QWxLSTtBQW1LTEQsRUFBQUEsSUFuS0ssa0JBbUtDO0FBQ0YsU0FBS1AsTUFBTCxDQUFZb0Qsa0JBQVo7QUFDSDtBQXJLSSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyIvLyBMZWFybiBjYy5DbGFzczpcbi8vICAtIGh0dHBzOi8vZG9jcy5jb2Nvcy5jb20vY3JlYXRvci9tYW51YWwvZW4vc2NyaXB0aW5nL2NsYXNzLmh0bWxcbi8vIExlYXJuIEF0dHJpYnV0ZTpcbi8vICAtIGh0dHBzOi8vZG9jcy5jb2Nvcy5jb20vY3JlYXRvci9tYW51YWwvZW4vc2NyaXB0aW5nL3JlZmVyZW5jZS9hdHRyaWJ1dGVzLmh0bWxcbi8vIExlYXJuIGxpZmUtY3ljbGUgY2FsbGJhY2tzOlxuLy8gIC0gaHR0cHM6Ly9kb2NzLmNvY29zLmNvbS9jcmVhdG9yL21hbnVhbC9lbi9zY3JpcHRpbmcvbGlmZS1jeWNsZS1jYWxsYmFja3MuaHRtbFxuXG52YXIgdXNlcmRhdGEgPSByZXF1aXJlKCd1c2VyZGF0YScpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBteV9mbGlnaHRzX3dpbmRvdzp7XG4gICAgICAgICAgICB0eXBlOmNjLk5vZGUsXG4gICAgICAgICAgICBkZWZhdWx0Om51bGxcbiAgICAgICAgfSxcbiAgICAgICAgd2FyZWhvdXNlX3dpbmRvdzp7XG4gICAgICAgICAgICB0eXBlOmNjLk5vZGUsXG4gICAgICAgICAgICBkZWZhdWx0Om51bGxcbiAgICAgICAgfSxcbiAgICAgICAgYWN0aXZlZmxpZ2h0czp7XG4gICAgICAgICAgICB0eXBlOmNjLk5vZGUsXG4gICAgICAgICAgICBkZWZhdWx0Om51bGxcbiAgICAgICAgfSxcbiAgICAgICAgZmxpZ2h0czp7XG4gICAgICAgICAgICB0eXBlOmNjLk5vZGUsXG4gICAgICAgICAgICBkZWZhdWx0Om51bGxcbiAgICAgICAgfSxcbiAgICAgICAgc2hvcF93aW5kb3c6e1xuICAgICAgICAgICAgdHlwZTpjYy5Ob2RlLFxuICAgICAgICAgICAgZGVmYXVsdDpudWxsXG4gICAgICAgIH0sXG4gICAgICAgIGJ1aWxkaW5nc193aW5kb3c6e1xuICAgICAgICAgICAgdHlwZTpjYy5Ob2RlLFxuICAgICAgICAgICAgZGVmYXVsdDpudWxsXG4gICAgICAgIH0sXG4gICAgICAgIGJ1c2luZXNzX2ZsaWdodHNfd2luZG93OntcbiAgICAgICAgICAgIHR5cGU6Y2MuTm9kZSxcbiAgICAgICAgICAgIGRlZmF1bHQ6bnVsbFxuICAgICAgICB9LFxuICAgICAgICBzZXR0aW5nX3dpbmRvd3M6e1xuICAgICAgICAgICAgdHlwZTpjYy5Ob2RlLFxuICAgICAgICAgICAgZGVmYXVsdDpudWxsXG4gICAgICAgIH0sXG4gICAgICAgIHdhcm5pbmdfd2luZG93OntcbiAgICAgICAgICAgIHR5cGU6Y2MuTm9kZSxcbiAgICAgICAgICAgIGRlZmF1bHQ6bnVsbFxuICAgICAgICB9LFxuICAgICAgICB3aW5kb3c6e1xuICAgICAgICAgICAgdHlwZTpjYy5Ob2RlLFxuICAgICAgICAgICAgZGVmYXVsdDpudWxsXG4gICAgICAgIH0sXG4gICAgICAgIGFpcnBsYW5lczp7XG4gICAgICAgICAgICB0eXBlOmNjLk5vZGUsXG4gICAgICAgICAgICBkZWZhdWx0Om51bGxcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBMSUZFLUNZQ0xFIENBTExCQUNLUzpcblxuICAgIG9uTG9hZCAoKSB7XG4gICAgICAgIFxuICAgIH0sXG5cbiAgICBzdGFydCAoKSB7XG5cbiAgICB9LFxuXG4gICAgdXBkYXRlIChkdCkge1xuICAgICAgICBcbiAgICB9LFxuICAgIHNob3dhbGxmbGlnaHRzKCl7XG4gICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICBsZXQgYSA9IGNjLmluc3RhbnRpYXRlKHRoaXMubXlfZmxpZ2h0c193aW5kb3cpO1xuICAgICAgICBhLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIGEuZ2V0Q2hpbGRCeU5hbWUoXCJhY3RpdmVcIikuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIGEuZ2V0Q2hpbGRCeU5hbWUoXCJpbm5lclwiKS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLndpbmRvdy5hZGRDaGlsZChhKTtcbiAgICB9LFxuICAgIHNob3dmbHlpbmcoKXtcbiAgICAgICAgdGhpcy5oaWRlKCk7XG4gICAgICAgIGxldCBhID0gY2MuaW5zdGFudGlhdGUodGhpcy5teV9mbGlnaHRzX3dpbmRvdyk7XG4gICAgICAgIGEuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgYS5nZXRDaGlsZEJ5TmFtZShcImFjdGl2ZVwiKS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICBhLmdldENoaWxkQnlOYW1lKFwiaW5uZXJcIikuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMud2luZG93LmFkZENoaWxkKGEpO1xuICAgIH0sXG4gICAgc2hvd3dhcmVob3VzZSgpe1xuICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICAgICAgbGV0IGEgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLndhcmVob3VzZV93aW5kb3cpO1xuICAgICAgICBhLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMud2luZG93LmFkZENoaWxkKGEpO1xuICAgIH0sXG4gICAgZmx5OmZ1bmN0aW9uKGV2ZW50LGN1c3RvbUV2ZW50RGF0YSl7XG4gICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICB2YXIgZ28gPSAwO1xuICAgICAgICBpZih1c2VyZGF0YS5sZWZ0cy5sZWZ0ZnVlbD49Y3VzdG9tRXZlbnREYXRhLmZ1ZWwmJnVzZXJkYXRhLmxlZnRzLmxlZnRwYXNzZW5nZXI+PWN1c3RvbUV2ZW50RGF0YS5wYXNzZW5nZXIpe1xuICAgICAgICAgICAgZm9yKHZhciBvIGluIHVzZXJkYXRhLmFpcnBsYW5lZGF0YSl7XG4gICAgICAgICAgICAgICAgaWYodXNlcmRhdGEuYWlycGxhbmVkYXRhW29dLmxldmVsPT1jdXN0b21FdmVudERhdGEubGV2ZWwgJiYgdXNlcmRhdGEuYWlycGxhbmVkYXRhW29dLmlzZmx5aW5nPT0nZmFsc2UnKXtcbiAgICAgICAgICAgICAgICAgICAgdXNlcmRhdGEuYWlycGxhbmVkYXRhW29dLmlzZmx5aW5nID0gJ3RydWUnO1xuICAgICAgICAgICAgICAgICAgICB1c2VyZGF0YS5haXJwbGFuZWRhdGFbb10uZGVzdGluYXRpb24gPSBjdXN0b21FdmVudERhdGEubmFtZTtcbiAgICAgICAgICAgICAgICAgICAgdXNlcmRhdGEuYWlycGxhbmVkYXRhW29dLnJld2FyZCA9IGN1c3RvbUV2ZW50RGF0YS5yZXdhcmQ7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJkYXRhLmFpcnBsYW5lZGF0YVtvXS5lbmR0aW1lID0gRGF0ZS5wYXJzZShuZXcgRGF0ZSgpKS8xMDAwICsgY3VzdG9tRXZlbnREYXRhLnRpbWU7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJkYXRhLmxlZnRzLmxlZnRmdWVsIC09IGN1c3RvbUV2ZW50RGF0YS5mdWVsO1xuICAgICAgICAgICAgICAgICAgICB1c2VyZGF0YS5sZWZ0cy5sZWZ0cGFzc2VuZ2VyIC09IGN1c3RvbUV2ZW50RGF0YS5wYXNzZW5nZXI7XG4gICAgICAgICAgICAgICAgICAgIGlmKHVzZXJkYXRhLmFjaGlldmVtZW50W2N1c3RvbUV2ZW50RGF0YS5pZF1bMV09PTMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJyXCIpO1xuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJkYXRhLmFjaGlldmVtZW50W2N1c3RvbUV2ZW50RGF0YS5pZF1bMF0gKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHVzZXJkYXRhLmFjaGlldmVtZW50W2N1c3RvbUV2ZW50RGF0YS5pZF1bMF09PTEwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyZGF0YS5hY2hpZXZlbWVudFtjdXN0b21FdmVudERhdGEuaWRdWzFdKz0xO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJkYXRhLmFsbGZpbGUuc3RhcnMgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyZGF0YS5hY2hpZXZlbWVudFtjdXN0b21FdmVudERhdGEuaWRdWzBdID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBnbyA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZihnbyA9PSAwKXtcbiAgICAgICAgICAgIGlmKHVzZXJkYXRhLmxlZnRzLmxlZnRmdWVsPGN1c3RvbUV2ZW50RGF0YS5mdWVsfHx1c2VyZGF0YS5sZWZ0cy5sZWZ0cGFzc2VuZ2VyPGN1c3RvbUV2ZW50RGF0YS5wYXNzZW5nZXIpe1xuICAgICAgICAgICAgICAgIGxldCBpbm5lciA9ICdEbyBub3QgaGF2ZSBlbm91Z2ggZnVlbCBvciBwYXNzZW5nZXJzJztcbiAgICAgICAgICAgICAgICB0aGlzLnNob3d3YXJuaW5nKGlubmVyKTtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIGxldCBpbm5lciA9ICdEbyBub3QgaGF2ZSBhbiBhdmlsYWJsZSBwbGFuZSBvZiB0aGUgcmVxdWlyZWQgdHlwZS5cXG5CdXkgYSBuZXcgcGxhbmUgb3Igd2FpdCBmb3IgdGhlIGN1cnJlbnQgZmxpZ2h0cyB0byByZXR1cm4uJ1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd3dhcm5pbmcoaW5uZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIHRvYWN0aXZlKCl7XG4gICAgICAgIHRoaXMud2luZG93LmdldENoaWxkQnlOYW1lKFwiTXlfZmxpZ2h0c193aW5kb3dcIikuZ2V0Q2hpbGRCeU5hbWUoXCJhY3RpdmVcIikuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy53aW5kb3cuZ2V0Q2hpbGRCeU5hbWUoXCJNeV9mbGlnaHRzX3dpbmRvd1wiKS5nZXRDaGlsZEJ5TmFtZShcImlubmVyXCIpLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICB0b2ZsaWdodGxpc3QoKXtcbiAgICAgICAgdGhpcy53aW5kb3cuZ2V0Q2hpbGRCeU5hbWUoXCJNeV9mbGlnaHRzX3dpbmRvd1wiKS5nZXRDaGlsZEJ5TmFtZShcImFjdGl2ZVwiKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy53aW5kb3cuZ2V0Q2hpbGRCeU5hbWUoXCJNeV9mbGlnaHRzX3dpbmRvd1wiKS5nZXRDaGlsZEJ5TmFtZShcImlubmVyXCIpLmFjdGl2ZSA9IHRydWU7XG4gICAgfSxcblxuICAgIHNob3d3YXJuaW5nKGlubmVyKXtcbiAgICAgICAgdGhpcy53YXJuaW5nX3dpbmRvdy5nZXRDaGlsZEJ5TmFtZShcIndhcm5pbmdfd2luZG93XCIpLmdldENoaWxkQnlOYW1lKFwiaW5uZXJcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBpbm5lcjtcbiAgICAgICAgbGV0IGEgPSBjYy5pbnN0YW50aWF0ZSh3YXJuaW5nX3dpbmRvdyk7XG4gICAgICAgIGEuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy53aW5kb3cuYWRkQ2hpbGQoYSk7XG4gICAgfSxcbiAgICBzaG93c2V0dGluZygpe1xuICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICAgICAgbGV0IGEgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnNldHRpbmdfd2luZG93cyk7XG4gICAgICAgIGEuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy53aW5kb3cuYWRkQ2hpbGQoYSk7XG4gICAgfSxcbiAgICBzaG93c2hvcCgpe1xuICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICAgICAgbGV0IGEgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnNob3Bfd2luZG93KTtcbiAgICAgICAgYS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLndpbmRvdy5hZGRDaGlsZChhKTtcbiAgICB9LFxuICAgIHNob3didWlsZGluZ3MoKXtcbiAgICAgICAgdGhpcy5oaWRlKCk7XG4gICAgICAgIGxldCBhID0gY2MuaW5zdGFudGlhdGUodGhpcy5idWlsZGluZ3Nfd2luZG93KTtcbiAgICAgICAgYS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLndpbmRvdy5hZGRDaGlsZChhKTtcbiAgICB9LFxuICAgIHNob3didXNpbmVzcygpe1xuICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICAgICAgbGV0IGEgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmJ1c2luZXNzX2ZsaWdodHNfd2luZG93KTtcbiAgICAgICAgYS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLndpbmRvdy5hZGRDaGlsZChhKTtcbiAgICB9LFxuICAgIGhpZGUoKXtcbiAgICAgICAgdGhpcy53aW5kb3cuZGVzdHJveUFsbENoaWxkcmVuKCk7XG4gICAgfVxufSk7XG4iXX0=